# 注意

本系统新增了基于 JWT + 持久化 Cookie（7 天）的认证逻辑，前端需要注意以下事项。

## 1. 前端请求需要携带什么

后端支持两种方式（二选一即可）：

1) **Cookie 自动携带**
- 登录成功后，后端会通过 `Set-Cookie` 写入 `HOSPITAL_AUTH_TOKEN`（HttpOnly）。
- 浏览器会自动在后续请求中携带该 Cookie。
- 前端需要开启跨域携带 Cookie。

2) **Authorization Header**
- 登录接口返回 `token`（JWT）。
- 前端也可以在请求头中显式携带：`Authorization: Bearer <token>`。

## 2. React 如何携带这些信息

### 2.1 使用 Cookie（推荐）

- `fetch` 示例：
```js
fetch('/api/xxx', {
  method: 'GET',
  credentials: 'include'
});
```

- `axios` 示例：
```js
axios.get('/api/xxx', { withCredentials: true });
```

注意：Cookie 是 HttpOnly，前端 JS **无法读取** `HOSPITAL_AUTH_TOKEN`，这是正常且更安全的行为。

### 2.2 使用 Authorization Header（可选）

```js
axios.get('/api/xxx', {
  headers: { Authorization: `Bearer ${token}` }
});
```

如果使用该方式，`token` 来自登录接口返回值。建议仅保存在内存中，避免写入 `localStorage` 以降低 XSS 风险。

## 3. 前端如何获取用户信息

1) 登录接口返回 `token / username / role`，可用于初始化前端状态。
2) 登录后可调用 `GET /api/auth/me` 获取当前登录用户信息（依赖 Cookie 或 Header）。

## 4. 登出

调用 `POST /api/auth/logout` 清除 Cookie。

## 5. 跨域提醒

当前后端 Cookie 设定为 `SameSite=Lax`，若前后端不在同一站点且需要跨站携带 Cookie，需要后端调整为 `SameSite=None` 且 `Secure=true`。
