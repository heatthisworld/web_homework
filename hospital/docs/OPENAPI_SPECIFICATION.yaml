openapi: 3.0.3
info:
  title: 医院管理系统API
  description: 医院管理系统的RESTful API文档
  version: 1.0.0
  contact:
    name: 医院管理系统开发团队
    email: support@hospital.com
servers:
  - url: http://localhost:8080
    description: 本地开发环境
paths:
  /api/auth/login:
    post:
      summary: 用户登录
      description: 用户登录获取JWT令牌
      tags:
        - 认证
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthRequest'
      responses:
        '200':
          description: 登录成功，返回JWT令牌
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
                example:
                  code: 0
                  msg: "success"
                  data:
                    token: "eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MTcxMTEwNTYwMH0.7eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8e"
                    username: "admin"
                    role: "ADMIN"
        '401':
          description: 用户名或密码错误
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
                example:
                  code: 401
                  msg: "用户名或密码错误"
                  data: null
  /api/auth/register:
    post:
      summary: 病人注册
      description: 注册新病人用户
      tags:
        - 认证
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
      responses:
        '200':
          description: 注册成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
                example:
                  code: 0
                  msg: "success"
                  data: "注册成功"
        '400':
          description: 用户名已存在或参数错误
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
                example:
                  code: 400
                  msg: "用户名已存在"
                  data: null
  /api/users:
    get:
      summary: 获取所有用户
      description: 获取系统中所有用户信息
      tags:
        - 用户管理
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 成功获取所有用户
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
    post:
      summary: 创建新用户
      description: 创建新用户
      tags:
        - 用户管理
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/User'
      responses:
        '200':
          description: 用户创建成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
  /api/users/{id}:
    get:
      summary: 获取指定ID的用户
      description: 根据ID获取用户信息
      tags:
        - 用户管理
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: 成功获取用户
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
        '404':
          description: 用户不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
                example:
                  code: 404
                  msg: "用户不存在"
                  data: null
    put:
      summary: 更新用户信息
      description: 根据ID更新用户信息
      tags:
        - 用户管理
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/User'
      responses:
        '200':
          description: 用户更新成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
    delete:
      summary: 删除用户
      description: 根据ID删除用户
      tags:
        - 用户管理
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: 用户删除成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
  /api/users/username/{username}:
    get:
      summary: 根据用户名获取用户
      description: 根据用户名获取用户信息
      tags:
        - 用户管理
      security:
        - bearerAuth: []
      parameters:
        - name: username
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: 成功获取用户
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
        '404':
          description: 用户不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
                example:
                  code: 404
                  msg: "用户不存在"
                  data: null
  /api/patients:
    get:
      summary: 获取所有病人
      description: 获取系统中所有病人信息
      tags:
        - 病人管理
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 成功获取所有病人
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
    post:
      summary: 创建新病人
      description: 创建新病人
      tags:
        - 病人管理
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Patient'
      responses:
        '200':
          description: 病人创建成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
  /api/patients/{id}:
    get:
      summary: 获取指定ID的病人
      description: 根据ID获取病人信息
      tags:
        - 病人管理
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: 成功获取病人
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
        '404':
          description: 病人不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
                example:
                  code: 404
                  msg: "病人不存在"
                  data: null
    put:
      summary: 更新病人信息
      description: 根据ID更新病人信息
      tags:
        - 病人管理
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Patient'
      responses:
        '200':
          description: 病人更新成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
    delete:
      summary: 删除病人
      description: 根据ID删除病人
      tags:
        - 病人管理
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: 病人删除成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
  /api/doctors:
    get:
      summary: 获取所有医生
      description: 获取系统中所有医生信息
      tags:
        - 医生管理
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 成功获取所有医生
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
    post:
      summary: 创建新医生
      description: 创建新医生
      tags:
        - 医生管理
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Doctor'
      responses:
        '200':
          description: 医生创建成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
  /api/doctors/{id}:
    get:
      summary: 获取指定ID的医生
      description: 根据ID获取医生信息
      tags:
        - 医生管理
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: 成功获取医生
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
        '404':
          description: 医生不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
                example:
                  code: 404
                  msg: "医生不存在"
                  data: null
    put:
      summary: 更新医生信息
      description: 根据ID更新医生信息
      tags:
        - 医生管理
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Doctor'
      responses:
        '200':
          description: 医生更新成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
    delete:
      summary: 删除医生
      description: 根据ID删除医生
      tags:
        - 医生管理
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: 医生删除成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
  /api/diseases:
    get:
      summary: 获取所有疾病
      description: 获取系统中所有疾病信息
      tags:
        - 疾病管理
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 成功获取所有疾病
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
    post:
      summary: 创建新疾病
      description: 创建新疾病
      tags:
        - 疾病管理
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Disease'
      responses:
        '200':
          description: 疾病创建成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
  /api/diseases/{id}:
    get:
      summary: 获取指定ID的疾病
      description: 根据ID获取疾病信息
      tags:
        - 疾病管理
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: 成功获取疾病
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
        '404':
          description: 疾病不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
                example:
                  code: 404
                  msg: "疾病不存在"
                  data: null
    put:
      summary: 更新疾病信息
      description: 根据ID更新疾病信息
      tags:
        - 疾病管理
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Disease'
      responses:
        '200':
          description: 疾病更新成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
    delete:
      summary: 删除疾病
      description: 根据ID删除疾病
      tags:
        - 疾病管理
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: 疾病删除成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
  /api/registrations:
    get:
      summary: 获取所有挂号记录
      description: 获取系统中所有挂号记录
      tags:
        - 挂号管理
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 成功获取所有挂号记录
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
    post:
      summary: 创建新挂号记录
      description: 创建新挂号记录
      tags:
        - 挂号管理
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Registration'
      responses:
        '200':
          description: 挂号记录创建成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
  /api/registrations/{id}:
    get:
      summary: 获取指定ID的挂号记录
      description: 根据ID获取挂号记录信息
      tags:
        - 挂号管理
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: 成功获取挂号记录
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
        '404':
          description: 挂号记录不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
                example:
                  code: 404
                  msg: "挂号记录不存在"
                  data: null
    put:
      summary: 更新挂号记录
      description: 根据ID更新挂号记录信息
      tags:
        - 挂号管理
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Registration'
      responses:
        '200':
          description: 挂号记录更新成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
    delete:
      summary: 删除挂号记录
      description: 根据ID删除挂号记录
      tags:
        - 挂号管理
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: 挂号记录删除成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
  /api/medical-records:
    get:
      summary: 获取所有病历记录
      description: 获取系统中所有病历记录
      tags:
        - 病历管理
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 成功获取所有病历记录
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
    post:
      summary: 创建新病历记录
      description: 创建新病历记录
      tags:
        - 病历管理
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MedicalRecord'
      responses:
        '200':
          description: 病历记录创建成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
  /api/medical-records/{id}:
    get:
      summary: 获取指定ID的病历记录
      description: 根据ID获取病历记录信息
      tags:
        - 病历管理
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: 成功获取病历记录
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
        '404':
          description: 病历记录不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
                example:
                  code: 404
                  msg: "病历记录不存在"
                  data: null
    put:
      summary: 更新病历记录
      description: 根据ID更新病历记录信息
      tags:
        - 病历管理
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MedicalRecord'
      responses:
        '200':
          description: 病历记录更新成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
    delete:
      summary: 删除病历记录
      description: 根据ID删除病历记录
      tags:
        - 病历管理
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: 病历记录删除成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
components:
  schemas:
    AuthRequest:
      type: object
      required:
        - username
        - password
      properties:
        username:
          type: string
          description: 用户名
          example: "admin"
        password:
          type: string
          description: 密码
          example: "admin123"
    AuthResponse:
      type: object
      properties:
        token:
          type: string
          description: JWT令牌
          example: "eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MTcxMTEwNTYwMH0.7eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8e"
        username:
          type: string
          description: 用户名
          example: "admin"
        role:
          type: string
          description: 用户角色
          example: "ADMIN"
    RegisterRequest:
      type: object
      required:
        - username
        - password
        - name
        - gender
        - age
        - idCard
        - phone
      properties:
        username:
          type: string
          description: 用户名
          example: "testuser"
        password:
          type: string
          description: 密码
          example: "test123"
        name:
          type: string
          description: 真实姓名
          example: "测试用户"
        gender:
          type: string
          description: 性别
          enum: ["MALE", "FEMALE"]
          example: "MALE"
        age:
          type: integer
          description: 年龄
          example: 30
        idCard:
          type: string
          description: 身份证号
          example: "110101199001011234"
        phone:
          type: string
          description: 手机号
          example: "13800138000"
        address:
          type: string
          description: 地址
          example: "北京市朝阳区"
    Result:
      type: object
      properties:
        code:
          type: integer
          description: 响应码，0表示成功，非0表示失败
          example: 0
        msg:
          type: string
          description: 响应消息
          example: "success"
        data:
          type: object
          description: 响应数据
    User:
      type: object
      properties:
        id:
          type: integer
          format: int64
          description: 用户ID
        username:
          type: string
          description: 用户名
          example: "admin"
        password:
          type: string
          description: 密码（已加密）
          example: "$2a$10$eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8eQ8e"
        role:
          type: string
          description: 用户角色
          enum: ["DOCTOR", "PATIENT", "ADMIN"]
          example: "ADMIN"
        createdAt:
          type: string
          format: date-time
          description: 创建时间
        updatedAt:
          type: string
          format: date-time
          description: 更新时间
    Patient:
      type: object
      properties:
        id:
          type: integer
          format: int64
          description: 病人ID
        user:
          $ref: '#/components/schemas/User'
          description: 关联的用户信息
        name:
          type: string
          description: 真实姓名
          example: "张三"
        gender:
          type: string
          description: 性别
          enum: ["MALE", "FEMALE"]
          example: "MALE"
        age:
          type: integer
          description: 年龄
          example: 30
        idCard:
          type: string
          description: 身份证号
          example: "110101199001011234"
        phone:
          type: string
          description: 手机号
          example: "13800138000"
        address:
          type: string
          description: 地址
          example: "北京市朝阳区"
        createdAt:
          type: string
          format: date-time
          description: 创建时间
        updatedAt:
          type: string
          format: date-time
          description: 更新时间
    Doctor:
      type: object
      properties:
        id:
          type: integer
          format: int64
          description: 医生ID
        user:
          $ref: '#/components/schemas/User'
          description: 关联的用户信息
        name:
          type: string
          description: 真实姓名
          example: "李四"
        gender:
          type: string
          description: 性别
          enum: ["MALE", "FEMALE"]
          example: "MALE"
        title:
          type: string
          description: 职称
          example: "主任医师"
        phone:
          type: string
          description: 手机号
          example: "13900139000"
        department:
          type: string
          description: 科室
          example: "内科"
        createdAt:
          type: string
          format: date-time
          description: 创建时间
        updatedAt:
          type: string
          format: date-time
          description: 更新时间
    Disease:
      type: object
      properties:
        id:
          type: integer
          format: int64
          description: 疾病ID
        name:
          type: string
          description: 疾病名称
          example: "感冒"
        description:
          type: string
          description: 疾病描述
          example: "常见的上呼吸道感染疾病"
        department:
          type: string
          description: 所属科室
          example: "内科"
        createdAt:
          type: string
          format: date-time
          description: 创建时间
        updatedAt:
          type: string
          format: date-time
          description: 更新时间
    Registration:
      type: object
      properties:
        id:
          type: integer
          format: int64
          description: 挂号ID
        patient:
          $ref: '#/components/schemas/Patient'
          description: 关联的病人信息
        doctor:
          $ref: '#/components/schemas/Doctor'
          description: 关联的医生信息
        disease:
          $ref: '#/components/schemas/Disease'
          description: 关联的疾病信息
        appointmentTime:
          type: string
          format: date-time
          description: 预约时间
          example: "2025-12-15T10:00:00"
        status:
          type: string
          description: 挂号状态
          enum: ["PENDING", "CONFIRMED", "CANCELED"]
          example: "PENDING"
        createdAt:
          type: string
          format: date-time
          description: 创建时间
        updatedAt:
          type: string
          format: date-time
          description: 更新时间
    MedicalRecord:
      type: object
      properties:
        id:
          type: integer
          format: int64
          description: 病历ID
        patient:
          $ref: '#/components/schemas/Patient'
          description: 关联的病人信息
        doctor:
          $ref: '#/components/schemas/Doctor'
          description: 关联的医生信息
        disease:
          $ref: '#/components/schemas/Disease'
          description: 关联的疾病信息
        diagnosisDate:
          type: string
          format: date-time
          description: 诊断日期
          example: "2025-12-15T10:00:00"
        symptoms:
          type: string
          description: 症状描述
          example: "发热、咳嗽、乏力"
        diagnosis:
          type: string
          description: 诊断结果
          example: "急性上呼吸道感染"
        treatment:
          type: string
          description: 治疗方案
          example: "口服感冒药，多喝水，休息"
        prescription:
          type: string
          description: 处方
          example: "感冒灵颗粒，每日3次，每次1袋"
        notes:
          type: string
          description: 备注
          example: "注意休息，避免劳累"
        createdAt:
          type: string
          format: date-time
          description: 创建时间
        updatedAt:
          type: string
          format: date-time
          description: 更新时间
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT令牌认证
security:
  - bearerAuth: []
